<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Shaozj's blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Shaozj's blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Shaozj's blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Shaozj's blog">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Shaozj's blog</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Shaozj's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/01/08/yeoman/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/01/08/yeoman/" itemprop="url">yeoman 快速上手</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-08T16:35:53+08:00">
                2017-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/构建/" itemprop="url" rel="index">
                    <span itemprop="name">构建</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/01/08/yeoman/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/01/08/yeoman/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="项目文件名和目录结构">项目文件名和目录结构</h2><p>需要按照约定的方式 <code>generator-name</code> 给项目文件夹命名，name 为你的 generator 的名字。项目目录结构一般如下：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">generator-name</span><br><span class="line">├───package<span class="class">.json</span></span><br><span class="line">└───generators/</span><br><span class="line">    ├───app/</span><br><span class="line">    │   └───index<span class="class">.js</span></span><br><span class="line">    └───router/</span><br><span class="line">        └───index.js</span><br></pre></td></tr></table></figure>
<p>package.json 例子：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "<span class="attribute">name</span>": <span class="value"><span class="string">"generator-name"</span></span>,</span><br><span class="line">  "<span class="attribute">version</span>": <span class="value"><span class="string">"0.1.0"</span></span>,</span><br><span class="line">  "<span class="attribute">description</span>": <span class="value"><span class="string">""</span></span>,</span><br><span class="line">  "<span class="attribute">files</span>": <span class="value">[</span><br><span class="line">    <span class="string">"generators"</span></span><br><span class="line">  ]</span>,</span><br><span class="line">  "<span class="attribute">keywords</span>": <span class="value">[<span class="string">"yeoman-generator"</span>]</span>,</span><br><span class="line">  "<span class="attribute">dependencies</span>": <span class="value">&#123;</span><br><span class="line">    "<span class="attribute">yeoman-generator</span>": <span class="value"><span class="string">"^1.0.0"</span></span><br><span class="line">  </span>&#125;</span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure>
<p>name 属性必须为 generator- 开头，keywords 属性中必须包含 “yeoman-generator”。</p>
<p><code>yo name</code> 和 <code>yo name:router</code>，产生所需文件。</p>
<h2 id="编写_index-js">编写 index.js</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">'use strict'</span>;</span><br><span class="line"><span class="keyword">const</span> Generators = <span class="built_in">require</span>(<span class="string">'yeoman-generator'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">Generator</span> </span>&#123;</span><br><span class="line">  constructor(args, opts) &#123;</span><br><span class="line">    <span class="comment">// 为了正确初始化，需要调用 super constructor </span></span><br><span class="line">    <span class="keyword">super</span>(args, opts);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 然后，添加自己的代码 </span></span><br><span class="line">    <span class="keyword">this</span>.option(<span class="string">'babel'</span>); <span class="comment">// 这个方法添加了对 `--babel` flag 的支持</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 添加自己的方法</span></span><br><span class="line">  method1() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'method 1 just ran'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  method2() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'method 2 just ran'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>每个在 class 中添加的方法都会在 generator 被调用时被执行一次，而且一般是按顺序执行。不过，有些特殊的方法名会触法特殊的执行顺序。</p>
<h2 id="运行_generator">运行 generator</h2><p>在 generator-name/ 目录下的命令行中，输入:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(sudo) npm link</span><br></pre></td></tr></table></figure>
<p>这将安装你的项目依赖，并将本地文件链接到全局模块中。 成功后，即可通过 <code>yo name</code> 指令来生产项目，可以验证你写的 generator。</p>
<h2 id="运行循环（run_loop）">运行循环（run loop）</h2><p>run loop 是一个队列系统并支持优先级。优先级由特殊的 prototype 方法名决定。如果方法名未匹配优先级，则将放入 default 组。按运行顺序，可用的优先级名如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> initializing : 初始化阶段</span><br><span class="line"><span class="number">2.</span> prompting : 接受用户输入阶段</span><br><span class="line"><span class="number">3.</span> configuring : 保存配置信息和文件，如.editorconfig</span><br><span class="line"><span class="number">4.</span> <span class="keyword">default</span> : 非特定的功能函数名称，如上面说到的method1</span><br><span class="line"><span class="number">5.</span> writing : 生成项目目录结构阶段</span><br><span class="line"><span class="number">6.</span> conflicts : 统一处理冲突，如要生成的文件已经存在是否覆盖等处理</span><br><span class="line"><span class="number">7.</span> install : 安装依赖阶段，如通过npm、bower</span><br><span class="line"><span class="number">8.</span> end : 生成器即将结束</span><br></pre></td></tr></table></figure>
<p>下面是一个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">'use strict'</span>;</span><br><span class="line"><span class="keyword">const</span> Generators = <span class="built_in">require</span>(<span class="string">'yeoman-generator'</span>);</span><br><span class="line"><span class="keyword">const</span> utils = <span class="built_in">require</span>(<span class="string">'../../utils/all'</span>);</span><br><span class="line"><span class="keyword">const</span> prompts = <span class="built_in">require</span>(<span class="string">'./prompts'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> packageInfo = <span class="built_in">require</span>(<span class="string">'../../package.json'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> baseRootPath = path.join(__dirname, <span class="string">'react-webpack-multipage-template'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line"> * Base generator. Will copy all required files from react-webpack-multipage-template</span><br><span class="line"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppGenerator</span> <span class="keyword">extends</span> <span class="title">Generators</span>.<span class="title">Base</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  constructor(args, options) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">super</span>(args, options);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Make options available</span></span><br><span class="line">    <span class="keyword">this</span>.option(<span class="string">'skip-welcome-message'</span>, &#123;</span><br><span class="line">      desc: <span class="string">'Skip the welcome message'</span>,</span><br><span class="line">      type: <span class="built_in">Boolean</span>,</span><br><span class="line">      defaults: <span class="literal">false</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">this</span>.option(<span class="string">'skip-install'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Use our plain template as source</span></span><br><span class="line">    <span class="keyword">this</span>.sourceRoot(baseRootPath);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.config.save();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  initializing() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">this</span>.options[<span class="string">'skip-welcome-message'</span>]) &#123;</span><br><span class="line">      <span class="keyword">this</span>.log(<span class="built_in">require</span>(<span class="string">'yeoman-welcome'</span>));</span><br><span class="line">      <span class="keyword">this</span>.log(<span class="string">'Out of the box I include Webpack and some default React components.\n'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  prompting() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.prompt(prompts).then((answers) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Make sure to get the correct app name if it is not the default</span></span><br><span class="line">      <span class="keyword">if</span>(answers.appName !== utils.yeoman.getAppName()) &#123;</span><br><span class="line">        answers.appName = utils.yeoman.getAppName(answers.appName);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Set needed global vars for yo</span></span><br><span class="line">      <span class="keyword">this</span>.appName = answers.appName;</span><br><span class="line">      <span class="keyword">this</span>.style = answers.style;</span><br><span class="line">      <span class="keyword">this</span>.cssmodules = answers.cssmodules;</span><br><span class="line">      <span class="keyword">this</span>.postcss = answers.postcss;</span><br><span class="line">      <span class="keyword">this</span>.generatedWithVersion = <span class="built_in">parseInt</span>(packageInfo.version.split(<span class="string">'.'</span>).shift(), <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Set needed keys into config</span></span><br><span class="line">      <span class="keyword">this</span>.config.set(<span class="string">'appName'</span>, <span class="keyword">this</span>.appName);</span><br><span class="line">      <span class="keyword">this</span>.config.set(<span class="string">'appPath'</span>, <span class="keyword">this</span>.appPath);</span><br><span class="line">      <span class="keyword">this</span>.config.set(<span class="string">'style'</span>, <span class="keyword">this</span>.style);</span><br><span class="line">      <span class="keyword">this</span>.config.set(<span class="string">'cssmodules'</span>, <span class="keyword">this</span>.cssmodules);</span><br><span class="line">      <span class="keyword">this</span>.config.set(<span class="string">'postcss'</span>, <span class="keyword">this</span>.postcss);</span><br><span class="line">      <span class="keyword">this</span>.config.set(<span class="string">'generatedWithVersion'</span>, <span class="keyword">this</span>.generatedWithVersion);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  configuring() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Generate our package.json. Make sure to also include the required dependencies for styles</span></span><br><span class="line">    <span class="keyword">let</span> defaultSettings = <span class="keyword">this</span>.fs.readJSON(<span class="string">`<span class="subst">$&#123;baseRootPath&#125;</span>/package.json`</span>);</span><br><span class="line">    <span class="keyword">this</span>.log(<span class="string">'defaultSettings: '</span>, defaultSettings);</span><br><span class="line">    <span class="keyword">this</span>.log(<span class="string">'baseRootPath: '</span>, defaultSettings);</span><br><span class="line">    <span class="keyword">let</span> packageSettings = &#123;</span><br><span class="line">      name: <span class="keyword">this</span>.appName,</span><br><span class="line">      private: <span class="literal">true</span>,</span><br><span class="line">      version: <span class="string">'0.0.1'</span>,</span><br><span class="line">      description: <span class="string">`<span class="subst">$&#123;this.appName&#125;</span> - Generated by generator-react-multipage`</span>,</span><br><span class="line">      main: <span class="string">'src/index.js'</span>,</span><br><span class="line">      scripts: defaultSettings.scripts,</span><br><span class="line">      repository: <span class="string">''</span>,</span><br><span class="line">      keywords: [],</span><br><span class="line">      author: <span class="string">'Your name here'</span>,</span><br><span class="line">      devDependencies: defaultSettings.devDependencies,</span><br><span class="line">      dependencies: defaultSettings.dependencies</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add needed loaders if we have special styles</span></span><br><span class="line">    <span class="keyword">let</span> styleConfig = utils.config.getChoiceByKey(<span class="string">'style'</span>, <span class="keyword">this</span>.style);</span><br><span class="line">    <span class="keyword">if</span>(styleConfig &amp;&amp; styleConfig.packages) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> dependency <span class="keyword">of</span> styleConfig.packages) &#123;</span><br><span class="line">        packageSettings.devDependencies[dependency.name] = dependency.version;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add postcss module if enabled</span></span><br><span class="line">    <span class="keyword">let</span> postcssConfig = utils.config.getChoiceByKey(<span class="string">'postcss'</span>, <span class="string">'postcss'</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.postcss &amp;&amp; postcssConfig &amp;&amp; postcssConfig.packages) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> dependency <span class="keyword">of</span> postcssConfig.packages) &#123;</span><br><span class="line">        packageSettings.devDependencies[dependency.name] = dependency.version;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add cssmodules if enabled</span></span><br><span class="line">    <span class="keyword">const</span> cssmoduleConfig = utils.config.getChoiceByKey(<span class="string">'cssmodules'</span>, <span class="string">'cssmodules'</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.cssmodules &amp;&amp; cssmoduleConfig &amp;&amp; cssmoduleConfig.packages) &#123;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> dependency <span class="keyword">of</span> cssmoduleConfig.packages) &#123;</span><br><span class="line">        packageSettings.dependencies[dependency.name] = dependency.version;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.fs.writeJSON(<span class="keyword">this</span>.destinationPath(<span class="string">'package.json'</span>), packageSettings);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  writing() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> excludeList = [</span><br><span class="line">      <span class="string">'LICENSE'</span>,</span><br><span class="line">      <span class="string">'README.md'</span>,</span><br><span class="line">      <span class="string">'CHANGELOG.md'</span>,</span><br><span class="line">      <span class="string">'node_modules'</span>,</span><br><span class="line">      <span class="string">'package.json'</span>,</span><br><span class="line">      <span class="string">'.istanbul.yml'</span>,</span><br><span class="line">      <span class="string">'.travis.yml'</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get all files in our repo and copy the ones we should</span></span><br><span class="line">    fs.readdir(<span class="keyword">this</span>.sourceRoot(), (err, items) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> items) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Skip the item if it is in our exclude list</span></span><br><span class="line">        <span class="keyword">if</span>(excludeList.indexOf(item) !== -<span class="number">1</span>) &#123;</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Copy all items to our root</span></span><br><span class="line">        <span class="keyword">let</span> fullPath = path.join(baseRootPath, item);</span><br><span class="line">        <span class="keyword">if</span>(fs.lstatSync(fullPath).isDirectory()) &#123;</span><br><span class="line">          <span class="keyword">this</span>.bulkDirectory(item, item);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (item === <span class="string">'.npmignore'</span>) &#123;</span><br><span class="line">            <span class="keyword">this</span>.copy(item, <span class="string">'.gitignore'</span>);</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.copy(item, item);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  install() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Currently buggy!</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.postcss) &#123;</span><br><span class="line">      <span class="keyword">const</span> postcss = <span class="built_in">require</span>(<span class="string">'./postcss'</span>);</span><br><span class="line">      postcss.write(path.join(<span class="keyword">this</span>.destinationRoot(), <span class="string">'conf/webpack/Base.js'</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">this</span>.options[<span class="string">'skip-install'</span>]) &#123;</span><br><span class="line">      <span class="keyword">this</span>.installDependencies(&#123; bower: <span class="literal">false</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = AppGenerator;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/23/webpack-optimization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/23/webpack-optimization/" itemprop="url">webpack 构建优化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-23T10:21:56+08:00">
                2016-12-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端-构建/" itemprop="url" rel="index">
                    <span itemprop="name">前端,构建</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/12/23/webpack-optimization/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/23/webpack-optimization/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="两个问题">两个问题</h3><ol>
<li>包体积过大</li>
<li>打包速度太慢</li>
</ol>
<h3 id="优化1_webpack-DllPlugin">优化1 webpack.DllPlugin</h3><blockquote>
<p>能加快打包速度，减小自身业务代码打包后的体积，但代码总体积（包含了第三方库）反而增大</p>
</blockquote>
<p>项目中我们要将第三方库的代码单独打包，一般采用的方式是 webpack.optimize.CommonsChunkPlugin 这个插件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">entry: &#123;</span><br><span class="line"> vendor: [<span class="string">'react'</span>, <span class="string">'react-dom'</span>] <span class="comment">// 类库</span></span><br><span class="line">&#125;;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">  name: <span class="string">'vendor'</span>,</span><br><span class="line">  filename: <span class="string">'vendor.js'</span>,</span><br><span class="line">  minChunks: <span class="literal">Infinity</span></span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure>
<p>然而，用这种方式，每次我们重新构建代码时，vendor 的代码都要重新构建，从而使得构建的速度变慢。  </p>
<p>webpack.DllPlugin 就可以解决这个问题，将第三方库事先编译为dll库，之后构建项目自身源码时，就不许要重新构建dll库中的代码。</p>
<p><strong>首先，我们需要编写 webpack.dll.config.js 。</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line">	</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    vendor: [<span class="string">'react'</span>, <span class="string">'react-dom'</span>, <span class="string">'antd'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.join(__dirname, <span class="string">'build'</span>),</span><br><span class="line">    filename: <span class="string">'[name].dll.js'</span>,</span><br><span class="line">    library: <span class="string">'[name]_library'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">      path: path.join(__dirname, <span class="string">'build'</span>, <span class="string">'[name]-manifest.json'</span>),</span><br><span class="line">      name: <span class="string">'[name]_library'</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>其实，webpack 中的插件也都可以用在 webpack.dll 配置文件中。  </p>
<p>执行 <code>webpack --config webpack.dll.config.js</code> 后，即可在 build 目录下找到生成的 dll bundle 和对应的 manifest 文件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; webpack --config webpack.dll.config.js</span><br><span class="line"></span><br><span class="line">Hash: <span class="number">674</span>d064bed0bcc476713</span><br><span class="line">Version: webpack <span class="number">1.14</span><span class="number">.0</span></span><br><span class="line">Time: <span class="number">4349</span>ms</span><br><span class="line">        Asset     Size  Chunks             Chunk Names</span><br><span class="line">vendor.dll.js  <span class="number">3.59</span> MB       <span class="number">0</span>  [emitted]  vendor</span><br><span class="line">   [<span class="number">0</span>] dll vendor <span class="number">12</span> bytes &#123;<span class="number">0</span>&#125; [built]</span><br><span class="line">    + <span class="number">913</span> hidden modules</span><br></pre></td></tr></table></figure>
<p><strong>然后，我们在 webpack.config.js 中配置  DLLReferencePlugin 插件。</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line"><span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">  context: __dirname,</span><br><span class="line">  manifest: <span class="built_in">require</span>(<span class="string">'./build/vendor-manifest.json'</span>)</span><br><span class="line">&#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>在 html 中，需要手动引入 dll 库</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"/build/vendor.dll.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p><strong>性能对比</strong></p>
<p><strong><em>首次构建:(build)</em></strong><br>采用 CommonsChunkPlugin ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Hash: <span class="number">6</span>ade5ef99f806b597685</span><br><span class="line">Version: webpack <span class="number">1.14</span><span class="number">.0</span></span><br><span class="line">Time: <span class="number">13349</span>ms</span><br><span class="line">                    Asset     Size  Chunks             Chunk Names</span><br><span class="line">program-list/index.js.map  <span class="number">18.7</span> kB       <span class="number">2</span>  [emitted]  program-list/index</span><br><span class="line">           index/index.js  <span class="number">26.2</span> kB       <span class="number">0</span>  [emitted]  index/index</span><br><span class="line">    program-list/index.js  <span class="number">19.3</span> kB       <span class="number">2</span>  [emitted]  program-list/index</span><br><span class="line">    theme-manage/index.js   <span class="number">622</span> kB       <span class="number">3</span>  [emitted]  theme-manage/index</span><br><span class="line">                vendor.js  <span class="number">1.43</span> MB       <span class="number">4</span>  [emitted]  vendor</span><br><span class="line">       index/index.js.map  <span class="number">19.3</span> kB       <span class="number">0</span>  [emitted]  index/index</span><br><span class="line">   <span class="keyword">new</span>-theme/index.js.map   <span class="number">499</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">       <span class="keyword">new</span>-theme/index.js   <span class="number">446</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">theme-manage/index.js.map   <span class="number">727</span> kB       <span class="number">3</span>  [emitted]  theme-manage/index</span><br><span class="line">            vendor.js.map  <span class="number">1.71</span> MB       <span class="number">4</span>  [emitted]  vendor</span><br><span class="line">               index.html  <span class="number">2.45</span> kB          [emitted]  </span><br><span class="line">           <span class="keyword">new</span>-theme.html  <span class="number">2.46</span> kB          [emitted]  </span><br><span class="line">        program-list.html  <span class="number">2.47</span> kB          [emitted]  </span><br><span class="line">        theme-manage.html  <span class="number">2.47</span> kB          [emitted]</span><br></pre></td></tr></table></figure>
<p>采用 DllPlugin ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Hash: <span class="number">6</span>f2755df167fdbf28a55</span><br><span class="line">Version: webpack <span class="number">1.14</span><span class="number">.0</span></span><br><span class="line">Time: <span class="number">8209</span>ms</span><br><span class="line">                    Asset     Size  Chunks             Chunk Names</span><br><span class="line">program-list/index.js.map  <span class="number">10.4</span> kB       <span class="number">2</span>  [emitted]  program-list/index</span><br><span class="line">           index/index.js  <span class="number">26.1</span> kB       <span class="number">0</span>  [emitted]  index/index</span><br><span class="line">    program-list/index.js    <span class="number">12</span> kB       <span class="number">2</span>  [emitted]  program-list/index</span><br><span class="line">    theme-manage/index.js  <span class="number">48.4</span> kB       <span class="number">3</span>  [emitted]  theme-manage/index</span><br><span class="line">                vendor.js   <span class="number">303</span> kB       <span class="number">4</span>  [emitted]  vendor</span><br><span class="line">       index/index.js.map  <span class="number">19.3</span> kB       <span class="number">0</span>  [emitted]  index/index</span><br><span class="line">   <span class="keyword">new</span>-theme/index.js.map  <span class="number">99.5</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">       <span class="keyword">new</span>-theme/index.js   <span class="number">111</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">theme-manage/index.js.map  <span class="number">39.5</span> kB       <span class="number">3</span>  [emitted]  theme-manage/index</span><br><span class="line">            vendor.js.map   <span class="number">358</span> kB       <span class="number">4</span>  [emitted]  vendor</span><br><span class="line">               index.html   <span class="number">2.5</span> kB          [emitted]  </span><br><span class="line">           <span class="keyword">new</span>-theme.html  <span class="number">2.51</span> kB          [emitted]  </span><br><span class="line">        program-list.html  <span class="number">2.52</span> kB          [emitted]  </span><br><span class="line">        theme-manage.html  <span class="number">2.52</span> kB          [emitted]</span><br></pre></td></tr></table></figure>
<p>可以看到，用 DllPlugin 能比 CommonsChunkPlugin 约5s。这里的例子是一个多页面构建的例子。<br>注意，此处我们虽然看到 DllPlugin 打包出来的文件要比 CommonsChunkPlugin 的小，但其实是我们把第三方库提取到了 vendor.dll.js 中的原因，加上 vendor.dll.js 中的文件，DllPlugin 打包总文件体积更大。</p>
<p><strong><em>模块热加载(rebuild)</em></strong><br>采用 CommonsChunkPlugin ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Hash: d8187730060863aecaad</span><br><span class="line">Version: webpack <span class="number">1.14</span><span class="number">.0</span></span><br><span class="line">Time: <span class="number">2478</span>ms</span><br><span class="line">                               Asset      Size  Chunks             Chunk Names</span><br><span class="line"><span class="number">6</span>ade5ef99f806b597685.hot-update.json  <span class="number">36</span> bytes          [emitted]  </span><br><span class="line">                      index/index.js   <span class="number">26.2</span> kB       <span class="number">0</span>             index/index</span><br><span class="line">               program-list/index.js   <span class="number">19.3</span> kB       <span class="number">2</span>             program-list/index</span><br><span class="line">               theme-manage/index.js    <span class="number">622</span> kB       <span class="number">3</span>             theme-manage/index</span><br><span class="line">                           vendor.js   <span class="number">1.43</span> MB       <span class="number">4</span>  [emitted]  vendor</span><br><span class="line"><span class="number">1.6</span>ade5ef99f806b597685.hot-update.js   <span class="number">6.41</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">                  <span class="keyword">new</span>-theme/index.js    <span class="number">446</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">                  index/index.js.map   <span class="number">19.3</span> kB       <span class="number">0</span>             index/index</span><br><span class="line">           program-list/index.js.map   <span class="number">18.7</span> kB       <span class="number">2</span>             program-list/index</span><br><span class="line">           theme-manage/index.js.map    <span class="number">727</span> kB       <span class="number">3</span>             theme-manage/index</span><br><span class="line">              <span class="keyword">new</span>-theme/index.js.map    <span class="number">499</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line"><span class="number">1.6</span>ade5ef99f806b597685.hot-update.js.map   <span class="number">4.41</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">                       vendor.js.map   <span class="number">1.71</span> MB       <span class="number">4</span>  [emitted]  vendor</span><br></pre></td></tr></table></figure>
<p>采用 DllPlugin ：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Hash: ca95bad33ad492f0a11b</span><br><span class="line">Version: webpack <span class="number">1.14</span><span class="number">.0</span></span><br><span class="line">Time: <span class="number">1005</span>ms</span><br><span class="line">                                   Asset      Size  Chunks             Chunk Names</span><br><span class="line">    <span class="number">456</span>baae3287b91efa0d4.hot-update.json  <span class="number">36</span> bytes          [emitted]  </span><br><span class="line">                          index/index.js   <span class="number">26.1</span> kB       <span class="number">0</span>             index/index</span><br><span class="line">                   program-list/index.js     <span class="number">12</span> kB       <span class="number">2</span>             program-list/index</span><br><span class="line">                   theme-manage/index.js   <span class="number">48.4</span> kB       <span class="number">3</span>             theme-manage/index</span><br><span class="line">                               vendor.js    <span class="number">303</span> kB       <span class="number">4</span>  [emitted]  vendor</span><br><span class="line">    <span class="number">1.456</span>baae3287b91efa0d4.hot-update.js    <span class="number">6.4</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">                      <span class="keyword">new</span>-theme/index.js    <span class="number">111</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">                      index/index.js.map   <span class="number">19.3</span> kB       <span class="number">0</span>             index/index</span><br><span class="line">               program-list/index.js.map   <span class="number">10.4</span> kB       <span class="number">2</span>             program-list/index</span><br><span class="line">               theme-manage/index.js.map   <span class="number">39.5</span> kB       <span class="number">3</span>             theme-manage/index</span><br><span class="line">                  <span class="keyword">new</span>-theme/index.js.map   <span class="number">99.5</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line"><span class="number">1.456</span>baae3287b91efa0d4.hot-update.js.map   <span class="number">4.41</span> kB       <span class="number">1</span>  [emitted]  <span class="keyword">new</span>-theme/index</span><br><span class="line">                           vendor.js.map    <span class="number">358</span> kB       <span class="number">4</span>  [emitted]  vendor</span><br></pre></td></tr></table></figure>
<p>追求极致体验，dll 值得拥有。</p>
<p style="color: red">另外还需注意到的一点是，antd 这个包非常大，大概有 2.6m，用 dll 的方式，就一次把整个antd 的包都打入 vendor.dll.js 中，使得 vendor.dll.js 非常大。这在开发环境时，为了追求打包速度，可以不考虑包大小。在生产环境下，建议还是采用 antd 推荐的 babel 插件，做按需加载处理，从而减小包的总大小</p>

<h3 id="优化2_HappyPack">优化2 HappyPack</h3><p><strong>配置：</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> HappyPack = <span class="built_in">require</span>(<span class="string">'happypack'</span>);</span><br><span class="line">	</span><br><span class="line">plugins: [</span><br><span class="line">    <span class="keyword">new</span> HappyPack(&#123;</span><br><span class="line">      id: <span class="string">'jsx'</span>,</span><br><span class="line">      threads: <span class="number">4</span>,</span><br><span class="line">      loaders: [<span class="string">'react-hot'</span>, <span class="string">'babel?'</span> + <span class="built_in">JSON</span>.stringify(&#123;</span><br><span class="line">        presets: [<span class="string">'es2015'</span>, <span class="string">'stage-0'</span>, <span class="string">'react'</span>]</span><br><span class="line">      &#125;)]</span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br><span class="line">    </span><br><span class="line">loaders: [</span><br><span class="line">	&#123;</span><br><span class="line">	    test: <span class="regexp">/\.(js|jsx)$/</span>,</span><br><span class="line">	    <span class="comment">//loader: 'react-hot!babel-loader',</span></span><br><span class="line">	    loaders: [<span class="string">'happypack/loader?id=jsx'</span>],</span><br><span class="line">	    include: [].concat(</span><br><span class="line">	      config.additionalPaths,</span><br><span class="line">	      [ path.join(__dirname, <span class="string">'/../src'</span>) ]</span><br><span class="line">	    )</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>采用 happypack 能进一步将构建时间从10s提升至5s。</p>
<p>以上两个优化都是优化了构建速度，然而并没能减小代码编译后包的体积大小，这是以后需要继续探索改进的地方。</p>
<h3 id="参考文档：">参考文档：</h3><ol>
<li><a href="https://segmentfault.com/a/1190000005770042" target="_blank" rel="external">开发工具心得：如何 10 倍提高你的 Webpack 构建效率</a>  </li>
<li><a href="https://github.com/lcxfs1991/blog/issues/2" target="_blank" rel="external">webpack使用优化（基本篇）</a>  </li>
<li><a href="https://github.com/lcxfs1991/blog/issues/7" target="_blank" rel="external">webpack使用优化（react篇）</a>  </li>
<li><a href="https://segmentfault.com/a/1190000005969643" target="_blank" rel="external">webpack 的 dll 功能</a>  </li>
<li><a href="https://zhuanlan.zhihu.com/p/21748318" target="_blank" rel="external">彻底解决Webpack打包性能问题</a>  </li>
<li><a href="https://segmentfault.com/a/1190000005969488" target="_blank" rel="external">使用 webpack + react + redux + es6 开发组件化前端项目</a></li>
<li><a href="https://github.com/amireh/happypack" target="_blank" rel="external">happypack github</a> </li>
<li>webpack 2.1 beta20 + happypack 多线程</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/15/fetch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/15/fetch/" itemprop="url">fetch</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-15T10:37:12+08:00">
                2016-12-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/12/15/fetch/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/15/fetch/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>用 XMLHttpRequest 来执行异步请求，虽然有用，却并不是最佳 api。它在设计上不符合职责分离原则，将输入、输出和用事件来跟踪的状态混杂在一个对象里(<a href="http://www.w3school.com.cn/xmldom/dom_http.asp" target="_blank" rel="external">XMLHttpRequest 对象</a>)。而且基于事件的异步模型写起来也没有现代的 Promise，generator/yield，async/await 友好。<br>Fetch 的出现就是为了解决 XHR 的问题，其主要优点有：  </p>
<ul>
<li>语法简洁，更加语义化</li>
<li>基于标准 Promise 实现，支持 async/await</li>
<li>同构方便，使用 <a href="https://github.com/matthew-andrews/isomorphic-fetch" target="_blank" rel="external">isomorphic-fetch</a></li>
</ul>
<p>Fetch API 旨在用来简化 HTTP 请求，它包含以下类和方法：</p>
<ul>
<li>fetch 方法：用于发起 HTTP 请求</li>
<li>Request 类：用来描述请求</li>
<li>Response 类：用来表示响应</li>
<li>Headers 类：用来表示 HTTP 头部信息</li>
</ul>
<p>这些类和方法在网上有着丰富的教程，在此不做赘述，可以查阅参考文献。</p>
<h3 id="常见的坑">常见的坑</h3><ul>
<li>fetch 请求默认是不带 cookie 的，需要设置 <code>fetch(url, {credentials: &#39;include&#39;})</code></li>
<li>服务器返回 400，500 错误码时并不会 reject，只有网络错误这些导致请求不能完成时，fetch 才会被 reject。可以用<code>response.status</code> 或 <code>response.ok</code> 判断服务端是否返回错误。</li>
</ul>
<h3 id="fetch_发送_post_请求">fetch 发送 post 请求</h3><p><strong>$.ajax方法</strong></p>
<p>首先我们看下 $.ajax post 数据的方法。</p>
<pre><code>$<span class="built_in">.</span>ajax({
  <span class="keyword">type</span>: <span class="string">'POST'</span>,
  url: <span class="string">'/video/v5video/item/add.htm'</span>,
  <span class="built_in">data</span>: <span class="built_in">data</span>,
  dataType: <span class="string">'json'</span>
})
</code></pre><p>chrome 中的请求信息：</p>
<p><img src="http://ww1.sinaimg.cn/mw1024/694c764dgw1faqh1go0k7j20om08k40e.jpg" alt=""></p>
<p>这种情况下，服务器可以正常地解析 post 数据。</p>
<p><strong>方法1:</strong></p>
<pre><code>fetch('/video/v5video/item/add.htm', {
  <span class="keyword">method</span>: '<span class="type">POST</span>',
  headers: {
    '<span class="type">Content</span>-<span class="type">Type</span>': 'application/json'
  },
  body: <span class="type">JSON</span>.stringify(data),
  credentials: '<span class="keyword">include</span>'
})
</code></pre><p>chrome 中的请求信息：</p>
<p><img src="http://ww3.sinaimg.cn/large/694c764dgw1faqgc3g82oj20og0aq0v1.jpg" alt=""></p>
<p>可以看到，请求数据在 payload 中，在一些后台中（如webx），并不支持解析 payload 中的数据，此时将不能正常 post 数据。</p>
<p><strong>方法2:</strong></p>
<pre><code>fetch('/video/v5video/item/add.htm', {
  <span class="keyword">method</span>: '<span class="type">POST</span>',
  headers: {},
  body: setFormData(data),
  credentials: '<span class="keyword">include</span>'
});

function setFormData(data) {
  <span class="keyword">let</span> formData = new <span class="type">FormData</span>();
  <span class="keyword">for</span> (<span class="keyword">let</span> name <span class="keyword">in</span> data) {
    formData.append(name, data[name]);
  }
  <span class="keyword">return</span> formData;
}
</code></pre><p>chrome 中的请求信息：</p>
<p><img src="http://ww4.sinaimg.cn/mw1024/694c764dgw1faqgumuylcj20ro09gmze.jpg" alt=""></p>
<p>存在着和方法一同样的问题。</p>
<p><strong>方法3:</strong></p>
<p>有没有什么方法可以让 fetch 发出和 $.ajax 一样的请求呢？答案是有的：</p>
<pre><code>fetch('/video/v5video/item/add.htm', {
  <span class="keyword">method</span>: '<span class="type">POST</span>',
  body: setUrlSearchParams(data),
  credentials: '<span class="keyword">include</span>'
});

function setUrlSearchParams(data) {
  <span class="keyword">let</span> urlSearchParams = new <span class="type">URLSearchParams</span>();
  <span class="keyword">for</span> (<span class="keyword">let</span> name <span class="keyword">in</span> data) {
    urlSearchParams.append(name, data[name]);
  }
  <span class="keyword">return</span> urlSearchParams;
}  
</code></pre><p>chrome 中的请求信息：</p>
<p><img src="http://ww4.sinaimg.cn/mw1024/694c764dgw1faqh7rneixj20rq06ygn9.jpg" alt=""></p>
<p>这样就达到了和 <code>$.ajax</code> 一样的效果了。</p>
<h3 id="参考文献">参考文献</h3><ul>
<li>[1] <a href="https://fetch.spec.whatwg.org/" target="_blank" rel="external">Fetch Living Standard</a></li>
<li>[2] <a href="https://github.com/github/fetch" target="_blank" rel="external">A window.fetch JavaScript polyfill</a></li>
<li>[3] <a href="https://www.w3ctech.com/topic/854" target="_blank" rel="external">这个API很“迷人”——(新的Fetch API)</a></li>
<li>[4] <a href="https://segmentfault.com/a/1190000006039533" target="_blank" rel="external">Fetch API</a></li>
<li>[5] <a href="https://github.com/camsong/blog/issues/2" target="_blank" rel="external">传统 Ajax 已死，Fetch 永生</a></li>
<li>[6] <a href="http://blog.csdn.net/mhmyqn/article/details/25561535" target="_blank" rel="external">AJAX POST请求中参数以form data和request payload形式在servlet中的获取方式</a></li>
<li>[7] <a href="http://www.voidcn.com/blog/hsbirenjie/article/p-6206418.html" target="_blank" rel="external">Fetch发送POST请求的坑与解决方案</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/04/nginx-eclipse-proxy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/04/nginx-eclipse-proxy/" itemprop="url">mac下eclipse起服务器使用80端口</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-04T16:18:45+08:00">
                2016-12-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/nginx/" itemprop="url" rel="index">
                    <span itemprop="name">nginx</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/12/04/nginx-eclipse-proxy/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/04/nginx-eclipse-proxy/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="方法">方法</h3><ul>
<li>使用第三方代理软件nginx</li>
</ul>
<h3 id="步骤">步骤</h3><ul>
<li><p>1、安装pcre</p>
<ul>
<li>下载pcre <a href="http://www.pcre.org/" target="_blank" rel="external">http://www.pcre.org/</a></li>
<li><p>安装pcre  </p>
<pre><code><span class="char">$ </span>cd ~/<span class="class">Downloads</span>
<span class="char">$ </span>tar xvzf pcre-<span class="number">8.5</span>
<span class="char">$ </span>cd pcre-<span class="number">8.5</span>
<span class="char">$ </span>sudo ./configure --prefix=/usr/local
<span class="char">$ </span>sudo make
<span class="char">$ </span>sudo make install 
</code></pre></li>
</ul>
</li>
<li><p>2、安装Nginx</p>
<ul>
<li><p>下载Nginx <a href="http://nginx.org/" target="_blank" rel="external">http://nginx.org/</a></p>
</li>
<li><p>安装Nginx</p>
<pre><code><span class="char">$ </span>cd ~/<span class="class">Downloads</span>
<span class="char">$ </span>tar xvzf nginx-<span class="number">1.6</span><span class="number">.0</span>.tar.gz
<span class="char">$ </span>cd nginx-<span class="number">1.6</span><span class="number">.0</span>
<span class="char">$ </span>sudo ./configure --prefix=/usr/local/nginx --with-http_ssl_module --with-cc-opt=<span class="comment">"-Wno-deprecated-declarations"</span>
<span class="char">$ </span>sudo make
<span class="char">$ </span>sudo make install
</code></pre></li>
</ul>
</li>
<li><p>3、开启Nginx</p>
<ul>
<li>将/usr/local/nginx/sbin加入到环境变量里</li>
<li><p>运行  </p>
<pre><code><span class="variable">$ </span>sudo nginx 
</code></pre></li>
<li><p>停止</p>
<pre><code>$ sudo nginx <span class="operator">-s</span> stop
</code></pre></li>
</ul>
</li>
<li><p>3、配置Nginx</p>
<ul>
<li><p>配置nginx，监听80端口，然后跳转到8080端口。在目录<code>/usr/local/nginx/conf</code>下找到配置文件<code>nginx.conf</code>，如下编辑</p>
<pre><code><span class="title">server</span> {
    <span class="title">listen</span>       <span class="number">80</span>;
    <span class="title">server_name</span>  tv-lq.alibaba.net;
    <span class="title">add_header</span> Cache-Control private;
    <span class="title">charset</span> utf-<span class="number">8</span>;
    <span class="title">fastcgi_intercept_errors</span> <span class="built_in">on</span>;

    <span class="title">location</span> / {
        <span class="title">proxy_next_upstream</span> http_502 http_504 <span class="built_in">error</span> timeout invalid_header;
        <span class="title">proxy_pass</span> <span class="url">http://127.0.0.1:8080</span>;
        <span class="title">proxy_set_header</span> Host <span class="variable">$host</span>;
        <span class="title">proxy_set_header</span> X-Forwarded-For <span class="variable">$remote_addr</span>;
        <span class="title">proxy_intercept_errors</span> <span class="built_in">on</span>;
    }
}
</code></pre></li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/12/04/webpack-muti-page-build/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/12/04/webpack-muti-page-build/" itemprop="url">webpack 多页面构建</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-04T13:29:23+08:00">
                2016-12-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/12/04/webpack-muti-page-build/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/04/webpack-muti-page-build/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="webpack_多页面构建">webpack 多页面构建</h2><h3 id="目标：">目标：</h3><ul>
<li>基于webpack支持react多页面构建（不用gulp，gulp-webpack 构建速度太慢[3]), generator-react-webpack 对单页面支持很好，但对多页面，需要改造</li>
<li>提高开发人员的效率</li>
<li>并能对项目进行足够的性能优化</li>
<li>提高构建的效率</li>
</ul>
<h3 id="配置文件编写（webpack-config-js）">配置文件编写（webpack.config.js）</h3><h4 id="示例：">示例：</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">var</span> glob = <span class="built_in">require</span>(<span class="string">'glob'</span>);</span><br><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">var</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">var</span> node_dir = path.join(__dirname, <span class="string">'./node_modules/'</span>);</span><br><span class="line"><span class="keyword">var</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取所有入口文件</span></span><br><span class="line"><span class="keyword">var</span> getEntry = <span class="function"><span class="keyword">function</span>(<span class="params">globPath</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> entries = &#123;</span><br><span class="line">        vendor: [<span class="string">'jquery'</span>,<span class="string">'react'</span>,<span class="string">'react-dom'</span>,<span class="string">'./src/app'</span>] <span class="comment">// 类库</span></span><br><span class="line">    &#125;;</span><br><span class="line">    glob.sync(globPath).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">entry</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> pathname = entry.split(<span class="string">'/'</span>).splice(-<span class="number">2</span>).join(<span class="string">'/'</span>).split(<span class="string">'.'</span>)[<span class="number">0</span>];</span><br><span class="line">        entries[pathname] = [entry];</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">console</span>.log(entries);</span><br><span class="line">    <span class="keyword">return</span> entries;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 判断是否是在当前生产环境</span></span><br><span class="line"><span class="keyword">var</span> isProduction = process.env.NODE_ENV === <span class="string">'production'</span>;</span><br><span class="line"><span class="keyword">var</span> entries = getEntry(<span class="string">'./src/view/*/*.jsx'</span>);</span><br><span class="line"><span class="keyword">var</span> chunks = <span class="built_in">Object</span>.keys(entries);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: entries,</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">        filename: isProduction ?<span class="string">'js/[name].[hash:8].js'</span>:<span class="string">'js/[name].js'</span>,</span><br><span class="line">        publicPath: <span class="string">'/dist/'</span>,</span><br><span class="line">        chunkFilename: <span class="string">'chunk/[name].chunk.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        noParse:[</span><br><span class="line">            <span class="comment">/*path.join(node_dir,'./react/dist/react.min.js'),</span><br><span class="line">            path.join(node_dir,'./jquery/dist/jquery.min.js'),</span><br><span class="line">            path.join(node_dir,'./react-dom/dist/react-dom.min.js')*/</span></span><br><span class="line">        ],</span><br><span class="line">        loaders: [&#123;</span><br><span class="line">            test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">            loader: <span class="string">'babel'</span>,</span><br><span class="line">            query: &#123;</span><br><span class="line">                presets: [<span class="string">'es2015'</span>, <span class="string">'react'</span>]</span><br><span class="line">            &#125;,</span><br><span class="line">            exclude: node_dir</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">            loader: ExtractTextPlugin.extract(<span class="string">'style'</span>, <span class="string">'css'</span>)</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">            loader: ExtractTextPlugin.extract(<span class="string">'style'</span>, <span class="string">'css!less'</span>)</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            test: <span class="regexp">/\.(png|jpe?g|gif)$/</span>,</span><br><span class="line">            loader: <span class="string">'url?limit=8192&amp;name=img/[hash:8].[ext]'</span></span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            <span class="comment">//文件加载器，处理文件静态资源</span></span><br><span class="line">            test: <span class="regexp">/\.(woff|woff2|ttf|eot|svg)(\?v=[0-9]\.[0-9]\.[0-9])?$/</span>,</span><br><span class="line">            loader: <span class="string">'file?limit=10000&amp;name=fonts/[hash:8].[ext]'</span></span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        extensions: [<span class="string">''</span>, <span class="string">'.js'</span>, <span class="string">'.jsx'</span>, <span class="string">'.json'</span>],</span><br><span class="line">        alias: &#123;</span><br><span class="line">            mod: node_dir</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> webpack.ProvidePlugin(&#123;</span><br><span class="line">            $: <span class="string">'jquery'</span>, <span class="comment">// 使jquery变成全局变量,不用在自己文件require('jquery')了</span></span><br><span class="line">            jQuery: <span class="string">'jquery'</span>,</span><br><span class="line">            React: <span class="string">'react'</span>,</span><br><span class="line">            ReactDOM: <span class="string">'react-dom'</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 类库统一打包生成一个文件</span></span><br><span class="line">        <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">            name: <span class="string">'vendor'</span>,</span><br><span class="line">            filename: isProduction ? <span class="string">'js/vendor.[hash:8].js'</span>:<span class="string">'js/vendor.js'</span>,</span><br><span class="line">            minChunks: <span class="number">3</span> <span class="comment">// 提取使用3次以上的模块，打包到vendor里</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(&#123;</span><br><span class="line">            compress: &#123;</span><br><span class="line">                warnings: <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> ExtractTextPlugin(isProduction ? <span class="string">'css/[name].[hash:8].css'</span>:<span class="string">'css/[name].css'</span>)</span><br><span class="line">    ],</span><br><span class="line">    devtool: isProduction ? <span class="literal">null</span> : <span class="string">'source-map'</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 生成HTML文件</span></span><br><span class="line">chunks.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">pathname</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pathname == <span class="string">'vendor'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> conf = &#123;</span><br><span class="line">        title: <span class="string">'My App'</span>,</span><br><span class="line">        filename: isProduction? <span class="string">'../view/'</span> + pathname + <span class="string">'.html'</span> : pathname + <span class="string">'.html'</span>,</span><br><span class="line">        template: <span class="string">'./src/template.html'</span>,</span><br><span class="line">        inject: <span class="string">'body'</span>,</span><br><span class="line">        minify: &#123;</span><br><span class="line">            removeComments: <span class="literal">true</span>,</span><br><span class="line">            collapseWhitespace: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">if</span> (pathname <span class="keyword">in</span> <span class="built_in">module</span>.exports.entry) &#123;</span><br><span class="line">        conf.chunks = [<span class="string">'vendor'</span>, pathname];</span><br><span class="line">        conf.hash = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">module</span>.exports.plugins.push(<span class="keyword">new</span> HtmlWebpackPlugin(conf));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="Webpack的配置主要包括以下几大项目：">Webpack的配置主要包括以下几大项目：</h4><ul>
<li><p><strong>entry</strong>：js入口源文件</p>
<ul>
<li>为了使用多入口文件，你可以给entry传入一个对象。对象的key代表入口点名字，value代表入口点。当使用多入口点的时候，需要重载output.filename，否责每个入口点都写入到同一个输出文件里面了。使用[name]来得到入口点名字。</li>
<li><p>例子：</p>
<pre><code><span class="collection">{
    entry: <span class="collection">{
        a: <span class="string">"./a"</span>,
        b: <span class="string">"./b"</span>,
        //支持数组形式，将加载数组中的所有模块，但以最后一个模块作为输出
        //该方法可以添加多个彼此不互相依赖的文件
        c: <span class="collection">[<span class="string">"./c"</span>, <span class="string">"./d"</span>]</span>
    }</span>,
    output: <span class="collection">{
        path: path.join<span class="list">(<span class="keyword">__dirname</span>, <span class="string">"dist"</span>)</span>,
        filename: <span class="string">"[name].entry.js"</span> // a.enrty.js, b.enrty.js, c.entry.js
    }</span>
}</span>
</code></pre></li>
</ul>
</li>
<li><p><strong>output</strong>：生成文件</p>
<ul>
<li><p>output参数是个对象，定义了输出文件的位置及名字.</p>
</li>
<li><p>例子：</p>
<pre><code><span class="tag">output</span>: {
    <span class="attribute">path</span>: <span class="string">"dist/js/page"</span>,
    <span class="attribute">publicPath</span>: <span class="string">"/output/"</span>,
    <span class="attribute">filename</span>: <span class="string">"[name].bundle.js"</span>
}

<span class="attribute">path</span>: 打包文件存放的绝对路径 
<span class="attribute">publicPath</span>: 网站运行时的访问路径 
<span class="attribute">filename</span>:打包后的文件名
</code></pre></li>
</ul>
</li>
<li><p><strong>module</strong>：模块加载器</p>
<ul>
<li><p>在webpack中JavaScript，CSS，LESS，TypeScript，JSX，CoffeeScript，图片等静态文件都是模块，不同模块的加载是通过模块加载器（webpack-loader）来统一管理的。loaders之间是可以串联的，一个加载器的输出可以作为下一个加载器的输入，最终返回到JavaScript上。</p>
</li>
<li><p>例子：</p>
<pre><code><span class="module"><span class="keyword">module</span>: </span>{
    <span class="comment">//加载器配置</span>
    loaders: [
        <span class="comment">//.css 文件使用 style-loader 和 css-loader 来处理</span>
        { 
            test: <span class="regexp">/\.css$/</span>, 
            loader: <span class="string">'style-loader!css-loader'</span> 
        },
        <span class="comment">//.js 文件使用 jsx-loader 来编译处理</span>
        { 
            test: <span class="regexp">/\.js$/</span>, 
            loader: <span class="string">'jsx-loader?harmony'</span> 
        },
        <span class="comment">//.scss 文件使用 style-loader、css-loader 和 sass-loader 来编译处理</span>
        { 
            test: <span class="regexp">/\.scss$/</span>, 
            loader: <span class="string">'style!css!sass?sourceMap'</span>
        },
        <span class="comment">//图片文件使用 url-loader 来处理，小于8kb的直接转为base64</span>
        { 
            test: <span class="regexp">/\.(png|jpg)$/</span>, 
            loader: <span class="string">'url-loader?limit=8192'</span>
        }
    ]
}    
</code></pre></li>
<li><p>多个loader可以用在同一个文件上并且被链式调用。链式调用时从右到左执行且loader之间用“!”来分割。</p>
</li>
<li>模块加载器（loader）自身可以根据传入不同的参数进行配置。  </li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>resolve</strong>：文件路径的指向</p>
<ul>
<li><p>webpack在构建包的时候会按目录的进行文件的查找，resolve属性中的extensions数组中用于配置程序可以自行补全哪些文件后缀：</p>
</li>
<li><p>例子：</p>
<pre><code><span class="string">resolve:</span> {
    <span class="comment">//查找module的话从这里开始查找</span>
<span class="label">    root:</span> <span class="string">'/pomy/github/flux-example/src'</span>, <span class="comment">//绝对路径</span>
    <span class="comment">//自动扩展文件后缀名，意味着我们require模块可以省略不写后缀名</span>
<span class="label">    extensions:</span> [<span class="string">''</span>, <span class="string">'.js'</span>, <span class="string">'.json'</span>, <span class="string">'.scss'</span>],
    <span class="comment">//模块别名定义，方便后续直接引用别名，无须多写长长的地址</span>
<span class="label">    alias:</span> {
        <span class="string">AppStore :</span> <span class="string">'js/stores/AppStores.js'</span>,<span class="comment">//后续直接 require('AppStore') 即可</span>
        <span class="string">ActionType :</span> <span class="string">'js/actions/ActionType.js'</span>,
        <span class="string">AppAction :</span> <span class="string">'js/actions/AppAction.js'</span>
    }
}
</code></pre></li>
</ul>
</li>
<li><p><strong>plugins</strong>：插件，比loader更强大，能使用更多webpack的api</p>
<ul>
<li><p>插件一般都是用于输出bundle的node模块。例如，uglifyJSPlugin获取bundle.js然后压缩和混淆内容以减小文件体积。类似的extract-text-webpack-plugin内部使用css-loader和style-loader来收集所有的css到一个地方最终将结果提取结果到一个独立的”styles.css“文件，并且在html里边引用style.css文件。</p>
<pre><code><span class="keyword">var</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">"extract-text-webpack-plugin"</span>);

<span class="module"><span class="keyword">module</span>: </span>{
    loaders: [
        {
            test: <span class="regexp">/\.css$/</span>,
            loader: ExtractTextPlugin.extract(<span class="string">"style-loader"</span>, <span class="string">"css-loader"</span>)
        },
        {
            test: <span class="regexp">/\.less$/</span>,
            loader: ExtractTextPlugin.extract(<span class="string">"style-loader"</span>, <span class="string">"css-loader!less-loader"</span>)
        }
    ]
},
plugins: [
    <span class="keyword">new</span> ExtractTextPlugin(<span class="string">"[name].css"</span>)
]
</code></pre></li>
<li><p>code-splitting 插件CommonsChunkPlugin</p>
<ul>
<li><p>将多次引用的模块单独打包</p>
<pre><code><span class="tag">new</span> <span class="tag">webpack</span><span class="class">.optimize</span><span class="class">.CommonsChunkPlugin</span>({
    <span class="attribute">name</span>: <span class="string">'vendor'</span>,
    <span class="attribute">filename</span>: isProduction ? <span class="string">'js/vendor.[hash:8].js'</span>:<span class="string">'js/vendor.js'</span>,
    <span class="attribute">minChunks</span>: <span class="number">3</span> <span class="comment">// 提取使用3次以上的模块，打包到vendor里</span>
})
</code></pre></li>
</ul>
</li>
<li><p>多页面 html 生成插件 html-webpack-plugin</p>
<ul>
<li><p>例子：</p>
<pre><code><span class="keyword">var</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);

chunks.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">pathname</span>) </span>{
    <span class="keyword">if</span> (pathname == <span class="string">'vendor'</span>) {
        <span class="keyword">return</span>;
    }
    <span class="keyword">var</span> conf = {
        title: <span class="string">'My App'</span>,
        filename: isProduction? <span class="string">'../view/'</span> + pathname + <span class="string">'.html'</span> : pathname + <span class="string">'.html'</span>,
        template: <span class="string">'./src/template.html'</span>,
        inject: <span class="string">'body'</span>,
        minify: {
            removeComments: <span class="literal">true</span>,
            collapseWhitespace: <span class="literal">false</span>
        }
    };
    <span class="keyword">if</span> (pathname <span class="keyword">in</span> <span class="built_in">module</span>.exports.entry) {
        conf.chunks = [<span class="string">'vendor'</span>, pathname];
        conf.hash = <span class="literal">false</span>;
    }
    <span class="built_in">module</span>.exports.plugins.push(<span class="keyword">new</span> HtmlWebpackPlugin(conf));
});
</code></pre></li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>* src目录下有个template.html文件，无需引入任何css和js，webpack会自动帮我们打包引入，`<span class="tag">&lt;<span class="title">%=</span> <span class="attribute">htmlWebpackPlugin.options.title</span> %&gt;</span>`读取配置好的页面标题

    <span class="comment"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">title</span>&gt;</span> <span class="tag">&lt;<span class="title">%=</span> <span class="attribute">htmlWebpackPlugin.options.title</span> %&gt;</span> <span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"app"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure></span>


* 最终通过打包，会生成对应入口的html文件，
</code></pre><p>比如src/view/index/index.js会生成view/index/index.html</p>
<pre><code>    <span class="comment"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="doctype">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">html</span> <span class="attribute">lang</span>=<span class="value">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">meta</span> <span class="attribute">charset</span>=<span class="value">"UTF-8"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">title</span>&gt;</span> My App <span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">link</span> <span class="attribute">href</span>=<span class="value">"/dist/css/vendor.abf9657f.css"</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">link</span> <span class="attribute">href</span>=<span class="value">"/dist/css/index/index.abf9657f.css"</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"app"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"/dist/js/vendor.abf9657f.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">"text/javascript"</span> <span class="attribute">src</span>=<span class="value">"/dist/js/index/index.abf9657f.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure></span>


* 你会发现相关资源文件都自动引入了，十分便捷。
</code></pre><h3 id="webpack_常用命令">webpack 常用命令</h3><ul>
<li>webpack 最基本的启动webpack命令</li>
<li>webpack -w 提供watch方法，实时进行打包更新</li>
<li>webpack -p 对打包后的文件进行压缩</li>
<li>webpack -d 提供SourceMaps，方便调试</li>
<li>webpack –colors 输出结果带彩色，比如：会用红色显示耗时较长的步骤</li>
<li>webpack –profile 输出性能数据，可以看到每一步的耗时</li>
<li>webpack –display-modules 默认情况下 node_modules 下的模块会被隐藏，加上这个参数可以显示这些被隐藏的模块</li>
</ul>
<h3 id="webpack_dev_server">webpack dev server</h3><ul>
<li><p>配置示例：</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="keyword">var</span> WebpackDevServer = <span class="built_in">require</span>(<span class="string">'webpack-dev-server'</span>);</span><br><span class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'./webpack.config.js'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> config.entry) &#123;</span><br><span class="line">	<span class="comment">// 每个入口文件加入 client websocket 热加载脚本</span></span><br><span class="line">	config.entry[i].unshift(</span><br><span class="line">		<span class="string">"webpack-dev-server/client?http://127.0.0.1:3000/"</span>, </span><br><span class="line">		<span class="string">"webpack/hot/only-dev-server"</span></span><br><span class="line">	);</span><br><span class="line">&#125;</span><br><span class="line">config.module.loaders.unshift(&#123;</span><br><span class="line">	test: <span class="regexp">/\.jsx?$/</span>,</span><br><span class="line">	loader: <span class="string">'react-hot'</span>,</span><br><span class="line">	exclude: <span class="regexp">/node_modules/</span></span><br><span class="line">&#125;);</span><br><span class="line">config.plugins.push(<span class="keyword">new</span> webpack.HotModuleReplacementPlugin());</span><br><span class="line"><span class="keyword">new</span> WebpackDevServer(webpack(config), &#123;</span><br><span class="line">	publicPath: config.output.publicPath,</span><br><span class="line">	hot: <span class="literal">true</span>,</span><br><span class="line">	historyApiFallback: <span class="literal">true</span>,</span><br><span class="line">	stats: &#123; colors: <span class="literal">true</span> &#125;</span><br><span class="line">	&#125;).listen(<span class="number">3000</span>, <span class="string">'127.0.0.1'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, result</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (err) &#123;</span><br><span class="line">	    <span class="built_in">console</span>.log(err);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'server start'</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>用处</p>
<ul>
<li>开启服务器调试环境</li>
<li>解决以下两个问题：<ul>
<li>webpack –watch 打包速度慢</li>
<li>不能做到hot replace </li>
</ul>
</li>
</ul>
</li>
<li><p>配置</p>
<ul>
<li><p><strong>Content Base</strong></p>
<ul>
<li>如果不进行设定的话，服务器伺服默认是在当前目录下。</li>
<li>命令行设置 <code>webpack-dev-server --content-base build/</code></li>
<li><p>webpack 配置</p>
<pre><code><span class="tag">devServer</span>: {
    <span class="attribute">contentBase</span>: <span class="string">'./src/'</span>,
    <span class="attribute">historyApiFallback</span>: true,
    <span class="attribute">hot</span>: true,
    <span class="attribute">port</span>: defaultSettings.port,
    <span class="attribute">publicPath</span>: <span class="string">'/assets/'</span>,
    <span class="attribute">noInfo</span>: false
}
</code></pre></li>
</ul>
<ul>
<li><p><strong>publicPath</strong></p>
<ul>
<li>webpack server 伺服的 bundle 是在内存中的，其相对路径由 publicPath 字段指定。</li>
<li>如果用以上的配置，bundle 可以通过地址 localhost:8080/assets/bundle.js 访问到。（注意：访问的不是output目录下的文件而是内存中的数据！）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>自动更新和热替换</p>
<ul>
<li><p>配置：</p>
<pre><code><span class="variable"><span class="keyword">var</span> config</span> = require(<span class="string">"./webpack.config.js"</span>);
config.entry.app.unshift(<span class="string">"webpack-dev-server/client?http://localhost:8080/"</span>, <span class="string">"webpack/hot/dev-server"</span>);
<span class="variable"><span class="keyword">var</span> compiler</span> = webpack(config);
<span class="variable"><span class="keyword">var</span> server</span> = new webpackDevServer(compiler, {
    hot: <span class="literal">true</span>
    ...
});
server.listen(<span class="number">8080</span>);
</code></pre><p>  关键配置： <code>config.entry.app.unshift(&quot;webpack-dev-server/client?http://localhost:8080/&quot;, &quot;webpack/hot/dev-server&quot;);</code></p>
<p>  在每个入口文件注入 client websocket 热加载脚本。</p>
</li>
</ul>
</li>
</ul>
<h3 id="参考文档：">参考文档：</h3><p><strong>webpack 多页面构建</strong>  </p>
<ol>
<li><a href="http://www.alloyteam.com/2016/03/using-react-to-write-a-simple-activity-pages-design-of-operating-system-article/" target="_blank" rel="external">使用 React 写个简单的活动页面运营系统</a>  </li>
<li><a href="http://to-u.xyz/2016/05/26/webpack-react-multiplePage/" target="_blank" rel="external">Webpack+React多页面应用探索</a>  </li>
<li><a href="http://www.jianshu.com/p/f6a2a47d084d" target="_blank" rel="external">webpack不适合多页面应用？你写的插件还不够多</a>  </li>
<li><a href="http://www.alloyteam.com/2015/10/optimization-of-alloyteam-series-building-articles/" target="_blank" rel="external">【AlloyTeam优化系列】构建篇</a><br><strong>webpack react generator</strong>  </li>
<li><a href="https://github.com/stylesuxx/generator-react-webpack" target="_blank" rel="external">generator-react-webpack</a><br><strong>webpack 构建优化</strong>  </li>
<li><a href="https://segmentfault.com/a/1190000005770042" target="_blank" rel="external">开发工具心得：如何 10 倍提高你的 Webpack 构建效率</a>  </li>
<li><a href="https://github.com/lcxfs1991/blog/issues/2" target="_blank" rel="external">webpack使用优化（基本篇）</a>  </li>
<li><a href="https://github.com/lcxfs1991/blog/issues/7" target="_blank" rel="external">webpack使用优化（react篇）</a><br><strong>webpack-dev-server</strong>  </li>
<li><a href="https://segmentfault.com/a/1190000006670084" target="_blank" rel="external">webpack-dev-server使用方法</a>  </li>
<li><a href="https://webpack.github.io/docs/webpack-dev-server.html" target="_blank" rel="external">WEBPACK DEV SERVER</a><br><strong>多入口以及code-splitting</strong>  </li>
<li><a href="https://github.com/webpack/webpack/tree/master/examples/multiple-entry-points" target="_blank" rel="external">webpack multiple-entry-points example</a>  </li>
<li><a href="https://webpack.github.io/docs/multiple-entry-points.html" target="_blank" rel="external">MULTIPLE ENTRY POINTS</a>  </li>
<li><a href="https://webpack.github.io/docs/code-splitting.html" target="_blank" rel="external">CODE SPLITTING</a><br><strong>webpack 配置</strong>  </li>
<li><a href="https://github.com/dwqs/blog/issues/21" target="_blank" rel="external">详解前端模块化工具-Webpack</a> <strong>不错的文章</strong>  </li>
<li><a href="https://github.com/chemdemo/chemdemo.github.io/issues/13" target="_blank" rel="external">【翻译】Webpack——令人困惑的地方</a><strong>好文章</strong><br><strong>webpack CommonsChunkPlugin详细教程</strong>  </li>
<li><a href="https://segmentfault.com/a/1190000006808865" target="_blank" rel="external">webpack CommonsChunkPlugin详细教程</a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/20/老生常谈之-css-居中/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/20/老生常谈之-css-居中/" itemprop="url">老生常谈之 css 居中</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-20T17:37:02+08:00">
                2016-08-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/css/" itemprop="url" rel="index">
                    <span itemprop="name">css</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/css/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/20/老生常谈之-css-居中/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/20/老生常谈之-css-居中/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="绝对定位居中(Absolute_Centering)技术">绝对定位居中(Absolute Centering)技术</h3><pre><code><span class="class">.Absolute-Center</span> <span class="rules">{  
  <span class="rule"><span class="attribute">margin</span>:<span class="value"> auto</span></span>;  
  <span class="rule"><span class="attribute">position</span>:<span class="value"> absolute</span></span>;  
  <span class="rule"><span class="attribute">top</span>:<span class="value"> <span class="number">0</span></span></span>; <span class="rule"><span class="attribute">left</span>:<span class="value"> <span class="number">0</span></span></span>; <span class="rule"><span class="attribute">bottom</span>:<span class="value"> <span class="number">0</span></span></span>; <span class="rule"><span class="attribute">right</span>:<span class="value"> <span class="number">0</span></span></span>;  
}</span>  
</code></pre><ul>
<li>解释：</li>
</ul>
<p>通过以上描述，绝对居中（AbsoluteCentering）的工作机理可以阐述如下：</p>
<p>1、在普通内容流（normal content flow）中，margin:auto的效果等同于margin-top:0;margin-bottom:0。<br>W3C中写道If ‘margin-top’, or’margin-bottom’ are ‘auto’, their used value is 0.</p>
<p>2、position:absolute使绝对定位块跳出了内容流，内容流中的其余部分渲染时绝对定位部分不进行渲染。</p>
<p>Developer.mozilla.org:…an element that is positioned absolutely is taken out of the flow and thustakes up no space</p>
<p>3、为块区域设置top: 0; left: 0; bottom: 0; right: 0;将给浏览器重新分配一个边界框，此时该块block将填充其父元素的所有可用空间，父元素一般为body或者声明为position:relative;的容器。</p>
<p>Developer.mozilla.org:For absolutely positioned elements, the top, right, bottom, and left propertiesspecify offsets from the edge of the element’s containing block (what theelement is positioned relative to).</p>
<p>4、  给内容块设置一个高度height或宽度width，能够防止内容块占据所有的可用空间，促使浏览器根据新的边界框重新计算margin:auto</p>
<p>Developer.mozilla.org: The margin of the[absolutely positioned] element is then positioned inside these offsets.</p>
<p>5、由于内容块被绝对定位，脱离了正常的内容流，浏览器会给margin-top,margin-bottom相同的值，使元素块在先前定义的边界内居中。<br>W3.org: If none of the three [top, bottom,height] are ‘auto’: If both ‘margin-top’ and ‘margin-bottom’ are ‘auto’, solvethe equation under the extra constraint that the two margins get equal values.AKA: center the block vertically</p>
<p>这么看来， margin:auto似乎生来就是为绝对居中(Absolute Centering)设计的，所以绝对居中(Absolute Centering)应该都兼容符合标准的现代浏览器。</p>
<p>简而言之（TL;DR）：绝对定位元素不在普通内容流中渲染，因此margin:auto可以使内容在通过top: 0; left: 0; bottom: 0;right: 0;设置的边界内垂直居中。</p>
<h3 id="负外边距(Negative_Margins)居中">负外边距(Negative Margins)居中</h3><pre><code><span class="class">.is-Negative</span> <span class="rules">{  
    <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">300px</span></span></span>;  
    <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">200px</span></span></span>;  
    <span class="rule"><span class="attribute">padding</span>:<span class="value"> <span class="number">20px</span></span></span>;  
    <span class="rule"><span class="attribute">position</span>:<span class="value"> absolute</span></span>;  
    <span class="rule"><span class="attribute">top</span>:<span class="value"> <span class="number">50%</span></span></span>; <span class="rule"><span class="attribute">left</span>:<span class="value"> <span class="number">50%</span></span></span>;  
    <span class="rule"><span class="attribute">margin-left</span>:<span class="value"> -<span class="number">170px</span></span></span>; <span class="comment">/* (width + padding)/2 */</span>  
    <span class="rule"><span class="attribute">margin-top</span>:<span class="value"> -<span class="number">120px</span></span></span>; <span class="comment">/* (height + padding)/2 */</span>  
}</span>
</code></pre><h3 id="Transform_居中">Transform 居中</h3><pre><code><span class="class">.is-Transformed</span> <span class="rules">{   
  <span class="rule"><span class="attribute">width</span>:<span class="value"> <span class="number">50%</span></span></span>;  
  <span class="rule"><span class="attribute">margin</span>:<span class="value"> auto</span></span>;  
  <span class="rule"><span class="attribute">position</span>:<span class="value"> absolute</span></span>;  
  <span class="rule"><span class="attribute">top</span>:<span class="value"> <span class="number">50%</span></span></span>; <span class="rule"><span class="attribute">left</span>:<span class="value"> <span class="number">50%</span></span></span>;  
  <span class="rule"><span class="attribute">-webkit-transform</span>:<span class="value"> <span class="function">translate</span>(-<span class="number">50%</span>,-<span class="number">50%</span>)</span></span>;  
      <span class="rule"><span class="attribute">-ms-transform</span>:<span class="value"> <span class="function">translate</span>(-<span class="number">50%</span>,-<span class="number">50%</span>)</span></span>;  
          <span class="rule"><span class="attribute">transform</span>:<span class="value"> <span class="function">translate</span>(-<span class="number">50%</span>,-<span class="number">50%</span>)</span></span>;  
}</span>  
</code></pre><h3 id="表格单元格（Table-Cell）居中">表格单元格（Table-Cell）居中</h3><pre><code>// HTML:
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"Center-Container is-Table"</span>&gt;</span>  
  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"Table-Cell"</span>&gt;</span>  
    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"Center-Block"</span>&gt;</span>  
    <span class="comment">&lt;!-- CONTENT --&gt;</span>  
    <span class="tag">&lt;/<span class="title">div</span>&gt;</span>  
  <span class="tag">&lt;/<span class="title">div</span>&gt;</span>  
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>  
</code></pre><p>css:</p>
<pre><code><span class="comment">// CSS:</span>
<span class="class">.Center-Container</span><span class="class">.is-Table</span> { <span class="attribute">display</span>: table; }  
<span class="class">.is-Table</span> <span class="class">.Table-Cell</span> {  
  <span class="attribute">display</span>: table-cell;  
  <span class="attribute">vertical-align</span>: middle;  
}  
<span class="class">.is-Table</span> <span class="class">.Center-Block</span> {  
  <span class="attribute">width</span>: <span class="number">50%</span>;  
  <span class="attribute">margin</span>: <span class="number">0</span> auto;  
}  
</code></pre><h3 id="行内块元素（Inline-Block）居中">行内块元素（Inline-Block）居中</h3><pre><code>// HTML:
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"box"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"content"</span>&gt;</span>我是内容<span class="tag">&lt;<span class="title">br</span> /&gt;</span>我也是内容<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
    <span class="tag">&lt;<span class="title">div</span> <span class="attribute">id</span>=<span class="value">"actor"</span>&gt;</span>我是演员<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
</code></pre><p>css:</p>
<pre><code><span class="comment">// CSS:</span>
<span class="id">#box</span> { <span class="attribute">height</span>: <span class="number">400px</span>; <span class="attribute">background</span>: <span class="hexcolor">#c00</span>;}
<span class="id">#content</span>, <span class="id">#actor</span> { <span class="attribute">display</span>: inline-block; <span class="attribute">vertical-align</span>: middle;}
<span class="id">#content</span> { <span class="attribute">font-size</span>: <span class="number">12px</span>; <span class="attribute">color</span>: <span class="hexcolor">#fff</span>;}
<span class="id">#actor</span> {<span class="attribute">height</span>: <span class="number">400px</span>; <span class="attribute">font-size</span>: <span class="number">0</span>;}
</code></pre><p>加粗体的部分是关键所在。原理是都显示为行框的高度由最高的行内框决定。div#actor作为演员，高度指定和父元素一致。<br>兼容性：支持inline-block的浏览器均可。对于IE6/7，可以先使用hack方式使其支持Inline-block后，使用此方法实现垂直居中。</p>
<h3 id="Flexbox居中">Flexbox居中</h3><pre><code><span class="class">.box</span> <span class="rules">{
  <span class="rule"><span class="attribute">display</span>:<span class="value"> flex</span></span>;
  <span class="rule"><span class="attribute">justify-content</span>:<span class="value"> center</span></span>;
  <span class="rule"><span class="attribute">align-items</span>:<span class="value"> center</span></span>;
}</span>
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/20/vim前端配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/20/vim前端配置/" itemprop="url">vim前端配置</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-20T15:37:52+08:00">
                2016-08-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/vim/" itemprop="url" rel="index">
                    <span itemprop="name">vim</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/20/vim前端配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/20/vim前端配置/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="VIM_插件管理器">VIM 插件管理器</h3><p><a href="https://github.com/VundleVim/Vundle.vim" target="_blank" rel="external">Vundle</a>  </p>
<ul>
<li><p>下载<br>  <code>$ git clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim</code></p>
</li>
<li><p>配置插件<br>  在<code>~/.vimrc</code>文件中添加  </p>
<pre><code><span class="operator"><span class="keyword">set</span> nocompatible              <span class="string">" be iMproved, required
filetype off                  "</span> <span class="keyword">required</span>

<span class="string">" set the runtime path to include Vundle and initialize
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()
"</span> alternatively, pass a <span class="keyword">path</span> <span class="keyword">where</span> Vundle should <span class="keyword">install</span> plugins
<span class="string">"call vundle#begin('~/some/path/here')

"</span> let Vundle manage Vundle, <span class="keyword">required</span>
<span class="keyword">Plugin</span> <span class="string">'VundleVim/Vundle.vim'</span>

<span class="string">" The following are examples of different formats supported.
"</span> <span class="keyword">Keep</span> <span class="keyword">Plugin</span> commands <span class="keyword">between</span> vundle#<span class="keyword">begin</span>/<span class="keyword">end</span>.
<span class="string">" plugin on GitHub repo
Plugin 'tpope/vim-fugitive'
"</span> <span class="keyword">plugin</span> <span class="keyword">from</span> <span class="keyword">http</span>://vim-scripts.org/vim/scripts.html
<span class="keyword">Plugin</span> <span class="string">'L9'</span>
<span class="string">" Git plugin not hosted on GitHub
Plugin 'git://git.wincent.com/command-t.git'
"</span> git repos <span class="keyword">on</span> your <span class="keyword">local</span> machine (<span class="keyword">i</span>.<span class="keyword">e</span>. <span class="keyword">when</span> working <span class="keyword">on</span> your own <span class="keyword">plugin</span>)
<span class="keyword">Plugin</span> <span class="string">'file:///home/gmarik/path/to/plugin'</span>
<span class="string">" The sparkup vim script is in a subdirectory of this repo called vim.
"</span> Pass the <span class="keyword">path</span> <span class="keyword">to</span> <span class="keyword">set</span> the runtimepath properly.
<span class="keyword">Plugin</span> <span class="string">'rstacruz/sparkup'</span>, {<span class="string">'rtp'</span>: <span class="string">'vim/'</span>}
<span class="string">" Install L9 and avoid a Naming conflict if you've already installed a
"</span> different <span class="keyword">version</span> somewhere <span class="keyword">else</span>.
<span class="keyword">Plugin</span> <span class="string">'ascenator/L9'</span>, {<span class="string">'name'</span>: <span class="string">'newL9'</span>}

<span class="string">" All of your Plugins must be added before the following line
call vundle#end()            "</span> <span class="keyword">required</span>
filetype <span class="keyword">plugin</span> indent <span class="keyword">on</span>    <span class="string">" required
"</span> <span class="keyword">To</span> <span class="keyword">ignore</span> <span class="keyword">plugin</span> indent changes, instead <span class="keyword">use</span>:
<span class="string">"filetype plugin on
"</span>
<span class="string">" Brief help
"</span> :PluginList       - lists configured plugins
<span class="string">" :PluginInstall    - installs plugins; append `!` to update or just :PluginUpdate
"</span> :PluginSearch foo - searches <span class="keyword">for</span> foo;</span> append `!` to refresh local <span class="operator"><span class="keyword">cache</span>
<span class="string">" :PluginClean      - confirms removal of unused plugins; append `!` to auto-approve removal
"</span>
<span class="string">" see :h vundle for more details or wiki for FAQ
"</span> Put your non-<span class="keyword">Plugin</span> <span class="keyword">stuff</span> <span class="keyword">after</span> this line  </span>
</code></pre></li>
<li><p>安装插件<br>   打开<code>vim</code>，运行<code>:PluginInstall</code></p>
</li>
</ul>
<h3 id="vim-jsbeautify">vim-jsbeautify</h3><p><a href="https://github.com/maksimr/vim-jsbeautify" target="_blank" rel="external">vim-jsbeautify</a></p>
<ul>
<li>在<code>~/.vimrc</code>中添加<br>  <code>Plugin &#39;maksimr/vim-jsbeautify&#39;</code></li>
<li>打开<code>vim</code>，运行<code>:PluginInstall</code></li>
</ul>
<h3 id="vim-javascript">vim-javascript</h3><p><a href="https://github.com/pangloss/vim-javascript" target="_blank" rel="external">vim-javascript</a></p>
<ul>
<li><ul>
<li>在<code>~/.vimrc</code>中添加<br><code>Plugin &#39;pangloss/vim-javascript&#39;</code></li>
</ul>
</li>
<li>打开<code>vim</code>，运行<code>:PluginInstall</code></li>
</ul>
<h3 id="语法高亮配置">语法高亮配置</h3><p>如果语法高亮没有生效，在<code>.vimrc</code> 加入以下3句：</p>
<pre><code><span class="keyword">syntax</span> enable <span class="string">" enable syntax hightlight and completion
</span><span class="keyword">syntax</span> <span class="keyword">on</span> <span class="string">" syntax highlighing
</span><span class="keyword">filetype</span> <span class="keyword">on</span> " <span class="keyword">try</span> <span class="keyword">to</span> detect <span class="keyword">file</span> types
</code></pre><h3 id="emmet-vim">emmet-vim</h3><p><a href="https://github.com/mattn/emmet-vim" target="_blank" rel="external">emmet-vim</a><br>还是一样的套路<br><code>Plugin &#39;mattn/emmet-vim&#39;</code><br>教程网站<a href="http://mattn.github.io/emmet-vim/" target="_blank" rel="external">http://mattn.github.io/emmet-vim/</a><br>中文教程<a href="https://www.zfanw.com/blog/zencoding-vim-tutorial-chinese.html" target="_blank" rel="external">https://www.zfanw.com/blog/zencoding-vim-tutorial-chinese.html</a></p>
<h3 id="我的_-vimrc_配置文件">我的 .vimrc 配置文件</h3><p><a href="https://github.com/shaozj/vimrc" target="_blank" rel="external">https://github.com/shaozj/vimrc</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/14/xss-安全防范/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/14/xss-安全防范/" itemprop="url">XSS 安全防范</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-14T14:18:15+08:00">
                2016-08-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/安全/" itemprop="url" rel="index">
                    <span itemprop="name">安全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/14/xss-安全防范/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/14/xss-安全防范/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>XSS是跨站脚本攻击，主要特点是开发者之外的人向页面内容注入了脚本执行。<br>XSS攻击有两个要素，一是来自用户或者三方的内容，二是被当做html或者javascript代码执行。<br>在面对XSS攻击时，需要牢记的一句话是：<strong>一切输入和输出都是敌对的！</strong></p>
<h3 id="XSS_攻击的输入点">XSS 攻击的输入点</h3><p>开发者之外的人可以通过以下输入点向页面中注入攻击脚本：</p>
<ul>
<li><code>window.location/document.location/document.referrer</code><ul>
<li>来自url的内容，因为链接可能来自外部页面，所以页面url应当视为外部用户内容。</li>
</ul>
</li>
<li>后端接口返回数据<ul>
<li>来自服务端的数据，这些数据可能由其它系统提供，其中可能包含用户的直接输入，所以应该把通过后端接口请求得到的数据视为外部用户产生内容。</li>
</ul>
</li>
<li><code>document.cookie</code><ul>
<li><code>cookie</code>有较多渠道被写入，为安全起见，应当视为用户产生内容。</li>
</ul>
</li>
<li><code>input.value/textarea.value</code><ul>
<li>用户产生内容。</li>
</ul>
</li>
</ul>
<h3 id="XSS_攻击的输出点">XSS 攻击的输出点</h3><p>XSS 攻击输出点是开发者在代码中写的语句，这些语句可能会将用户输入的内容作为代码执行，进而发生XSS 攻击。XSS 攻击主要有以下输出点：</p>
<ul>
<li><p>document.write/document.writeln：直接向文档流写入html内容，不提倡使用.</p>
<ul>
<li>如果希望用这种方式输出文本，在写入之前，应当使用document.createTextNode+appendChild将之转换成html文本语法。</li>
<li>如果确有特殊设计，希望用这种方式输出html，在写入之前，应当过滤html语法字符。</li>
</ul>
</li>
<li><p>innerHTML/$el.html()：直接向文档节点内插入html内容，除使用模板外，不提倡使用。</p>
<ul>
<li>如果希望用这种方式输出文本，应当使用innerText或者document.createTextNode+appendChild代替。</li>
<li>如果确有特殊设计，希望用这种方式输出html，在写入之前，应当过滤html语法字符。</li>
</ul>
</li>
<li><p>new Function：通过参数字符串创建新函数，除特殊场景外，不提倡使用。如果来自不安全的输入的字符需要拼接成字符串，建议使用JSON.stringify处理。</p>
</li>
<li><p>eval：把字符串当做函数执行，除特殊场景外，不提倡使用。如果来自不安全的输入的字符需要拼接成字符串，建议使用JSON.stringify处理。</p>
</li>
<li><p>setTimeout/setInterval：时间相关函数，如果第一个参数是字符串，那么效果类似eval，任何场景下，不提倡这样使用，第一个参数应该永远是函数类型。</p>
</li>
<li><p>image.src/link.href/a.href：设置url，因为可能是javascript协议，建议使用lib.httpurl解析url的结构和参数，确定域名属于安全域名。</p>
</li>
<li><p>window.location：跳转url，因为uri可能是javascript协议，建议使用lib.httpurl解析url的结构和参数，确定域名属于安全域名。</p>
</li>
</ul>
<h3 id="XSS_攻击实例">XSS 攻击实例</h3><h4 id="HTML_攻击">HTML 攻击</h4><ul>
<li><p>输出点</p>
<ul>
<li><code>&lt;img src=&quot;[代码]&quot;&gt;</code></li>
<li><p>现在弹个窗:</p>
<p> <code>&lt;img src=&quot;x&quot; onerror=&quot;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&quot;&gt;</code></p>
</li>
<li><p>原code:</p>
<p>  <code>&lt;img src=&quot;x&quot; onerror=&quot;alert(1)&quot;&gt;</code></p>
</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/08/07/ES6-模板字符串/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/08/07/ES6-模板字符串/" itemprop="url">ES6 模板字符串</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-08-07T11:49:14+08:00">
                2016-08-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/07/ES6-模板字符串/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/07/ES6-模板字符串/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>无论是前端还是后端，都存在着模板引擎。模板引擎有着丰富的表现力，使得我们可以根据不同的数据渲染出不同的页面结构以及内容。在es6中引入了模板字符串，使得我们可以在字符串中嵌入变量、表达式以及可以直接写多行字符串。另外，模板字符串还支持嵌套使用。这些特性，一些模板引擎基本的功能，我们可以用es6模板字符串来实现。</p>
<h3 id="for_循环">for 循环</h3><ul>
<li>一种比较直接的方式是：</li>
</ul>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$&#123;</span><br><span class="line">(()=&gt;&#123;</span><br><span class="line">  <span class="keyword">let</span> html = <span class="string">''</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = blocksData.length; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> curData = blocksData[i];</span><br><span class="line">    <span class="keyword">let</span> jsonData = JSON.stringify(curData);</span><br><span class="line">    html += `&lt;div <span class="keyword">class</span>=<span class="string">"item-box block4in1 $&#123;setClass(i)&#125;"</span> data-json=<span class="string">"$&#123;eH(jsonData)&#125;"</span> fe-role=<span class="string">"Widget"</span>&gt;</span><br><span class="line">               &lt;div <span class="keyword">class</span>=<span class="string">"item-content"</span>&gt;</span><br><span class="line">                 &lt;img <span class="keyword">class</span>=<span class="string">"poster"</span> src=<span class="string">"$&#123;eH(baseUrl + curData.recommendImage)&#125;"</span>&gt;</span><br><span class="line">                &lt;div <span class="keyword">class</span>=<span class="string">"item-mask"</span>&gt;&lt;/div&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">             &lt;/div&gt;`;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> html;</span><br><span class="line">&#125;)()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，我们利用一个立即执行函数，在函数内写一个for循环来实现。</p>
<ul>
<li>对以上的方法稍加优化，我们可以得到如下的代码：</li>
</ul>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$&#123;</span><br><span class="line">  blocksData.reduce((prev, next, i, arr) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> jsonData = JSON.stringify(next);</span><br><span class="line">    <span class="keyword">return</span> prev += </span><br><span class="line">    `&lt;div <span class="keyword">class</span>=<span class="string">"item-box block4in1 $&#123;setClass(i)&#125;"</span> data-json=<span class="string">"$&#123;eH(jsonData)&#125;"</span> fe-role=<span class="string">"Widget"</span>&gt;</span><br><span class="line">      &lt;div <span class="keyword">class</span>=<span class="string">"item-content"</span>&gt;</span><br><span class="line">        &lt;img <span class="keyword">class</span>=<span class="string">"poster"</span> src=<span class="string">"$&#123;eH(baseUrl + next.recommendImage)&#125;"</span>&gt;</span><br><span class="line">        &lt;div <span class="keyword">class</span>=<span class="string">"item-mask"</span>&gt;&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;`;</span><br><span class="line">  &#125;, <span class="string">''</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们利用了Array的reduce方法，从而不需要将代码封装在一个立即执行函数之中。</p>
<h3 id="if_else_条件判断">if else 条件判断</h3><p>很容易想到用三目运算符：</p>
<pre><code>${(data &amp;&amp; data != <span class="string">''</span>) ? `&lt;<span class="keyword">div</span>&gt;${data}&lt;/<span class="keyword">div</span>&gt;` : `&lt;<span class="keyword">div</span>&gt;no contnet&lt;/<span class="keyword">div</span>&gt;`}
</code></pre><p>如果只在存在数据时有相应的html，不存在数据时没有html，则可以这么写：</p>
<pre><code>${(<span class="typedef"><span class="keyword">data</span> &amp;&amp; <span class="keyword">data</span> != '') &amp;&amp; `&lt;div&gt;$<span class="container">{<span class="title">data</span>}</span>&lt;/div&gt;`}</span>
</code></pre><h3 id="特殊字符转义">特殊字符转义</h3><p>在模板中非常重要的一点是字符串的转义，因为涉及到安全的问题，一个简单的方式是利用标签模板：</p>
<pre><code>var message = SaferHTML<span class="escape">`&lt;</span>p&gt;${bonk.sender} has sent you <span class="literal">a</span> bonk.&lt;/p&gt;<span class="escape">`;</span>
</code></pre><p>上面的代码等价于：</p>
<pre><code><span class="keyword">var</span> <span class="keyword">message</span> = SaferHTML(templateData, bonk.sender);
</code></pre><p>其中，    templateData 是一个不可变的字符串数组，在上例中为：</p>
<pre><code><span class="built_in">Object</span>.freeze([<span class="string">"&lt;p&gt;"</span>, <span class="string">" has sent you a bonk.&lt;/p&gt;"</span>]
</code></pre><p>SaferHTML需要我们自己去实现：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SaferHTML</span>(<span class="params">templateData</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> s = templateData[<span class="number">0</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">    <span class="keyword">var</span> arg = <span class="built_in">String</span>(<span class="built_in">arguments</span>[i]);</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// Escape special characters in the substitution.</span></span><br><span class="line">    s += arg.replace(<span class="regexp">/&amp;/g</span>, <span class="string">"&amp;amp;"</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">"&amp;lt;"</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">"&amp;gt;"</span>);</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// Don't escape special characters in the template.</span></span><br><span class="line">    s += templateData[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>从安全角度来看，这个 SaferHTML 非常脆弱。在 HTML 中，不同的地方需要用不同的方式去转义，SaferHTML 并没有做到。<br>另外一点是，这个方法只适用于没有嵌套使用模板字符串的情况，如果嵌套使用，那么一些不该被转义的字符串页会被转义。在这种情况下，我们还是老老实实地对每一处改转义的地方进行转义.</p>
<p>首先，需要编写一个转义函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> reUnescapedHtml = <span class="regexp">/[&amp;&lt;&gt;"'`]/g</span>; <span class="comment">// 需要被转码的字符</span></span><br><span class="line"><span class="keyword">const</span> reHasUnescapedHtml = <span class="built_in">RegExp</span>(reUnescapedHtml.source); <span class="comment">// 测试是否有unescaped字符时不需要 'g'</span></span><br><span class="line"><span class="keyword">const</span> htmlEscapes = &#123;</span><br><span class="line">        <span class="string">'&amp;'</span>: <span class="string">'&amp;amp;'</span>,</span><br><span class="line">        <span class="string">'&lt;'</span>: <span class="string">'&amp;lt;'</span>,</span><br><span class="line">        <span class="string">'&gt;'</span>: <span class="string">'&amp;gt;'</span>,</span><br><span class="line">        <span class="string">'"'</span>: <span class="string">'&amp;quot;'</span>,</span><br><span class="line">        <span class="string">"'"</span>: <span class="string">'&amp;#39;'</span>,</span><br><span class="line">        <span class="string">'`'</span>: <span class="string">'&amp;#96;'</span></span><br><span class="line">      &#125;;</span><br><span class="line"><span class="keyword">const</span> escapeHtmlChar = basePropertyOf(htmlEscapes);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">basePropertyOf</span>(<span class="params">object</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> object == <span class="literal">null</span> ? <span class="literal">undefined</span> : object[key];</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span><br><span class="line">* 转义html字符串</span><br><span class="line">* @param string &#123;String&#125; 输入的字符串</span><br><span class="line">* @return &#123;String&#125; 转义后的字符串</span><br><span class="line">*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escapeHTML</span>(<span class="params">string</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (string &amp;&amp; reHasUnescapedHtml.test(string))</span><br><span class="line">    ? string.replace(reUnescapedHtml, escapeHtmlChar)</span><br><span class="line">    : string;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = escapeHTML;</span><br></pre></td></tr></table></figure>
<p>然后我们在每一个需要转义字符串的地方调用 escapeHTML 方法进行转义。</p>
<h3 id="参考文献：">参考文献：</h3><p><a href="https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet" target="_blank" rel="external">DOM based XSS Prevention Cheat Sheet</a><br><a href="https://segmentfault.com/a/1190000003874852" target="_blank" rel="external">[Web 安全] 了解XSS与防范</a><br><a href="http://wiki.jikexueyuan.com/project/es-six-deeply/template-strings.html" target="_blank" rel="external">模版字符串</a><br><a href="http://jaysoo.ca/2014/03/20/i18n-with-es6-template-strings/" target="_blank" rel="external">i18n with tagged template strings in ECMAScript 6</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/23/webpack学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhenjiang Shao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shaozj's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/23/webpack学习/" itemprop="url">webpack学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-23T10:51:53+08:00">
                2016-03-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/03/23/webpack学习/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/23/webpack学习/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="功能需求">功能需求</h4><ul>
<li>编译</li>
<li>压缩</li>
<li>web服务器</li>
</ul>
<h4 id="webpack学习">webpack学习</h4><pre><code>$ webpack --config XXX<span class="class">.js</span>   <span class="comment">//使用另一份配置文件（比如webpack.config2.js）来打包</span>

$ webpack --watch   <span class="comment">//监听变动并自动打包</span>

$ webpack -<span class="tag">p</span>    <span class="comment">//压缩混淆脚本，这个非常非常重要！</span>

$ webpack -d    <span class="comment">//生成map映射文件，告知哪些模块被最终打包到哪里了</span>
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Zhenjiang Shao" />
          <p class="site-author-name" itemprop="name">Zhenjiang Shao</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhenjiang Shao</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"shaozj"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  
















  





  

  

  

  

  

  

</body>
</html>
